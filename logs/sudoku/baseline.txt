####################
# Baseline: train CNN with cross entropy loss on Park 70k dataset
####################

python main.py --domain sudokucnf --reg cross --epochs 30 --gpu --bn --checkAcc --bar --folder PATH --save sudoku
device is cuda

The CNF is represented by a matrix C of shape torch.Size([8991, 729]):
tensor([[ 1.,  0.,  0.,  ...,  0.,  0.,  0.],
        [-1.,  0.,  0.,  ...,  0.,  0.,  0.],
        [-1.,  0.,  0.,  ...,  0.,  0.,  0.],
        ...,
        [ 0.,  0.,  0.,  ...,  0.,  0.,  0.],
        [ 0.,  0.,  0.,  ...,  0.,  0., -1.],
        [ 0.,  0.,  0.,  ...,  0.,  0., -1.]])
100%|████████████████████████████████████████████████████████████████| 56000/56000 [17:28<00:00, 53.42it/s]
Storing the trained model into PATH/sudoku_epoch_1.pt
0.00    70.70   0.00    70.42
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.67it/s]
Storing the trained model into PATH/sudoku_epoch_2.pt
0.15    76.72   0.10    76.11
100%|████████████████████████████████████████████████████████████████| 56000/56000 [12:59<00:00, 71.81it/s]
Storing the trained model into PATH/sudoku_epoch_3.pt
0.28    78.85   0.19    78.12
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.58it/s]
Storing the trained model into PATH/sudoku_epoch_4.pt
0.42    80.34   0.41    79.40
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.56it/s]
Storing the trained model into PATH/sudoku_epoch_5.pt
0.53    81.27   0.44    80.07
100%|████████████████████████████████████████████████████████████████| 56000/56000 [12:58<00:00, 71.93it/s]
Storing the trained model into PATH/sudoku_epoch_6.pt
0.66    82.05   0.47    80.58
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:00<00:00, 71.74it/s]
Storing the trained model into PATH/sudoku_epoch_7.pt
1.00    83.19   0.67    81.38
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.69it/s]
Storing the trained model into PATH/sudoku_epoch_8.pt
1.18    84.03   0.73    81.82
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:00<00:00, 71.70it/s]
Storing the trained model into PATH/sudoku_epoch_9.pt
1.55    84.80   0.89    82.01
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.68it/s]
Storing the trained model into PATH/sudoku_epoch_10.pt
1.78    85.38   0.93    82.04
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.57it/s]
Storing the trained model into PATH/sudoku_epoch_11.pt
2.10    86.36   0.94    82.27
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.63it/s]
Storing the trained model into PATH/sudoku_epoch_12.pt
2.46    86.99   0.94    82.11
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.60it/s]
Storing the trained model into PATH/sudoku_epoch_13.pt
2.68    87.73   0.90    82.05
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.54it/s]
Storing the trained model into PATH/sudoku_epoch_14.pt
2.97    88.40   0.99    81.81
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:03<00:00, 71.51it/s]
Storing the trained model into PATH/sudoku_epoch_15.pt
3.36    89.07   0.87    81.67
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:03<00:00, 71.52it/s]
Storing the trained model into PATH/sudoku_epoch_16.pt
3.83    89.70   1.00    81.51
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.65it/s]
Storing the trained model into PATH/sudoku_epoch_17.pt
4.17    90.36   0.91    81.36
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.60it/s]
Storing the trained model into PATH/sudoku_epoch_18.pt
4.42    90.74   0.87    81.13
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.64it/s]
Storing the trained model into PATH/sudoku_epoch_19.pt
4.27    90.91   0.90    80.86
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.64it/s]
Storing the trained model into PATH/sudoku_epoch_20.pt
5.16    91.86   0.84    81.04
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.55it/s]
Storing the trained model into PATH/sudoku_epoch_21.pt
5.28    92.16   0.90    80.76
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.68it/s]
Storing the trained model into PATH/sudoku_epoch_22.pt
5.03    92.30   0.79    80.59
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.57it/s]
Storing the trained model into PATH/sudoku_epoch_23.pt
5.09    92.45   0.71    80.60
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.65it/s]
Storing the trained model into PATH/sudoku_epoch_24.pt
6.02    93.09   0.67    80.48
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:00<00:00, 71.73it/s]
Storing the trained model into PATH/sudoku_epoch_25.pt
6.46    93.40   0.77    80.49
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.68it/s]
Storing the trained model into PATH/sudoku_epoch_26.pt
6.47    93.66   0.76    80.44
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.60it/s]
Storing the trained model into PATH/sudoku_epoch_27.pt
7.23    93.97   0.80    80.42
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:01<00:00, 71.69it/s]
Storing the trained model into PATH/sudoku_epoch_28.pt
5.03    93.43   0.59    80.20
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.55it/s]
Storing the trained model into PATH/sudoku_epoch_29.pt
9.19    94.78   0.71    80.64
100%|████████████████████████████████████████████████████████████████| 56000/56000 [13:02<00:00, 71.58it/s]
Storing the trained model into PATH/sudoku_epoch_30.pt
9.37    0.79
--- total time from beginning: 24572 seconds ---

####################
# Test on Park 70k
# The highest accuracy is on epoch 12, whose accuracy and time are reported in the paper
####################

python inference_trick.py --bn --gpu --folder PATH
device is cuda
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:45<00:00,  1.32it/s]
model: PATH/sudoku_epoch_1.pt,       0.6951  0.0001
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_2.pt,       0.7781  0.0189
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_3.pt,       0.8114  0.0454
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_4.pt,       0.8341  0.0739
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_5.pt,       0.8462  0.0987
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_6.pt,       0.8495  0.0949
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_7.pt,       0.8740  0.1676
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_8.pt,       0.8834  0.1960
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_9.pt,       0.8887  0.2201
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_10.pt,      0.8887  0.2270
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_11.pt,      0.8914  0.2243
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_12.pt,      0.8919  0.2329
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_13.pt,      0.8902  0.2213
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_14.pt,      0.8796  0.1930
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_15.pt,      0.8783  0.1827
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_16.pt,      0.8778  0.1890
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_17.pt,      0.8752  0.1800
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_18.pt,      0.8714  0.1661
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_19.pt,      0.8684  0.1553
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_20.pt,      0.8696  0.1599
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_21.pt,      0.8667  0.1524
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_22.pt,      0.8590  0.1320
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_23.pt,      0.8608  0.1366
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:43<00:00,  1.34it/s]
model: PATH/sudoku_epoch_24.pt,      0.8594  0.1314
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_25.pt,      0.8599  0.1344
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_26.pt,      0.8584  0.1330
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_27.pt,      0.8587  0.1309
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:51<00:00,  1.28it/s]
model: PATH/sudoku_epoch_28.pt,      0.8511  0.1027
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_29.pt,      0.8596  0.1311
100%|████████████████████████████████████████████████████████████████████| 219/219 [02:50<00:00,  1.28it/s]
model: PATH/sudoku_epoch_30.pt,      0.8588  0.1353
--- total time from beginning: 5125 seconds ---
